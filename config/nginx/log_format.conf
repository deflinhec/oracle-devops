# JSON access log formats for ELK; escape=json quotes and escapes values.
# Use $time_iso8601 for parseable timestamps; request_time/bytes_sent for analytics.
# Map status code to message (set in oracle.conf: map $status $status_message { ... })
log_format json_info escape=json '{'
  '"@timestamp":"$time_iso8601",'
  '"level":"info",'
  '"status":$status,'
  '"method":"$request_method",'
  '"scheme":"$scheme",'
  '"host":"$host",'
  '"uri":"$request_uri",'
  '"query_string":"$query_string",'
  '"request_time":$request_time,'
  '"body_bytes_sent":$body_bytes_sent,'
  '"request_length":$request_length,'
  '"remote_addr":"$remote_addr",'
  '"x_forwarded_for":"$http_x_forwarded_for",'
  '"referer":"$http_referer",'
  '"user_agent":"$http_user_agent",'
  '"content_type":"$sent_http_content_type",'
  '"upstream_cache_status":"$upstream_cache_status",'
  '"upstream_response_time":"$upstream_response_time"'
'}';